Question 1, 3, 4
SELECT p.title AS podcast_title,
    s2.id AS segment_id,
    s2.content,
    s2.start_time,
    s2.end_time,
    (s1.embedding <-> s2.embedding) AS distance
FROM segment AS s1
JOIN segment AS s2 ON s2.id <> s1.id
JOIN podcast AS p ON p.id = s2.podcast_id
WHERE s1.id = %s
ORDER BY distance ASC
LIMIT 5;

Question 2
SELECT p.title AS podcast_title,
    s2.id AS segment_id,
    s2.content,
    s2.start_time,
    s2.end_time,
    (s1.embedding <-> s2.embedding) AS distance
FROM segment AS s1
JOIN segment AS s2 ON s2.id <> s1.id
JOIN podcast AS p ON p.id = s2.podcast_id
WHERE s1.id = %s
ORDER BY distance DESC
LIMIT 5;

Question 5
WITH episode_centroids AS (
    SELECT podcast_id, AVG(embedding) AS centroid
    FROM segment
    GROUP BY podcast_id
),
query_segment AS (
    SELECT s.embedding, s.podcast_id
    FROM segment s
    WHERE s.id = %s
)
SELECT p.title,
    (qs.embedding <-> ec.centroid) AS distance
FROM query_segment AS qs
JOIN episode_centroids AS ec ON ec.podcast_id <> qs.podcast_id
JOIN podcast AS p ON p.id = ec.podcast_id
ORDER BY distance ASC
LIMIT 5;


Question 6
WITH episode_centroids AS (
    SELECT podcast_id, AVG(embedding) AS centroid
    FROM segment
    GROUP BY podcast_id
),
query_segment AS (
    SELECT ec.centroid
    FROM episode_centroids AS ec
    WHERE ec.podcast_id = %s
)
SELECT p.title,
    (qs.centroid <-> ec.centroid) AS distance
FROM query_segment AS qs
JOIN episode_centroids AS ec ON ec.podcast_id <> %s
JOIN podcast AS p ON p.id = ec.podcast_id
ORDER BY distance ASC
LIMIT 5;

=== Q1: 5 most similar to 267:476 ===
+---------------------------------------------------------------------------------------------------------------+--------------+------------------------------------------------------------+--------------+-------------+------------+
| podcast_title                                                                                                 | segment_id   | content                                                    |   start_time |    end_time |   distance |
|---------------------------------------------------------------------------------------------------------------+--------------+------------------------------------------------------------+--------------+-------------+------------|
| Podcast: Ryan Graves: UFOs, Fighter Jets, and Aliens | Lex Fridman Podcast #308                               | 113:2792     | encounters, human beings, if we were to meet another alien |  6725.620000 | 6729.860000 |   0.648345 |
| Podcast: Richard Dawkins: Evolution, Intelligence, Simulation, and Memes | Lex Fridman Podcast #87            | 268:1019     | Suppose we did meet an alien from outer space              |  2900.040000 | 2903.080000 |   0.655811 |
| Podcast: Jeffrey Shainline: Neuromorphic Computing and Optoelectronic Intelligence | Lex Fridman Podcast #225 | 305:3600     | but if we think of alien civilizations out there           |  9479.960000 | 9484.040000 |   0.659543 |
| Podcast: Michio Kaku: Future of Humans, Aliens, Space Travel & Physics | Lex Fridman Podcast #45              | 18:464       | So I think when we meet alien life from outer space,       |  1316.860000 | 1319.580000 |   0.666203 |
| Podcast: Alien Debate: Sara Walker and Lee Cronin | Lex Fridman Podcast #279                                  | 71:989       | because if aliens come to us                               |  2342.340000 | 2343.620000 |   0.674294 |
+---------------------------------------------------------------------------------------------------------------+--------------+------------------------------------------------------------+--------------+-------------+------------+


=== Q2: 5 most dissimilar to 267:476 ===
+------------------------------------------------------------------------------------------------------------+--------------+---------------------------------------------------+--------------+--------------+------------+
| podcast_title                                                                                              | segment_id   | content                                           |   start_time |     end_time |   distance |
|------------------------------------------------------------------------------------------------------------+--------------+---------------------------------------------------+--------------+--------------+------------|
| Podcast: Jason Calacanis: Startups, Angel Investing, Capitalism, and Friendship | Lex Fridman Podcast #161 | 119:218      | a 73 Mustang Grande in gold?                      |   519.960000 |   523.800000 |   1.615769 |
| Podcast: Rana el Kaliouby: Emotion AI, Social Robots, and Self-Driving Cars | Lex Fridman Podcast #322     | 133:2006     | for 94 car models.                                |  5818.620000 |  5820.820000 |   1.586336 |
| Podcast: Travis Stevens: Judo, Olympics, and Mental Toughness | Lex Fridman Podcast #223                   | 283:1488     | when I called down to get the sauna.              |  3709.340000 |  3711.100000 |   1.572553 |
| Podcast: Jeremy Howard: fast.ai Deep Learning Courses and Research | Lex Fridman Podcast #35               | 241:1436     | which has all the courses pre-installed.          |  4068.900000 |  4071.140000 |   1.566332 |
| Podcast: Joscha Bach: Nature of Reality, Dreams, and Consciousness | Lex Fridman Podcast #212              | 307:3933     | and very few are first class and some are budget. | 10648.640000 | 10650.960000 |   1.561634 |
+------------------------------------------------------------------------------------------------------------+--------------+---------------------------------------------------+--------------+--------------+------------+


=== Q3: 5 most similar to 48:511 ===
+------------------------------------------------------------------------------------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+-------------+------------+
| podcast_title                                                                                              | segment_id   | content                                                                                                                                                                                                                                                    |   start_time |    end_time |   distance |
|------------------------------------------------------------------------------------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+-------------+------------|
| Podcast: Andrew Huberman: Neuroscience of Optimal Performance | Lex Fridman Podcast #139                   | 155:648      | Is there something interesting to you or fundamental to you about the circuitry of the brain                                                                                                                                                               |  3798.480000 | 3805.840000 |   0.652300 |
| Podcast: Cal Newport: Deep Work, Focus, Productivity, Email, and Social Media | Lex Fridman Podcast #166   | 61:3707      | of what we might discover about neural networks?                                                                                                                                                                                                           |  8498.020000 | 8500.100000 |   0.712105 |
| Podcast: Matt Botvinick: Neuroscience, Psychology, and AI at DeepMind | Lex Fridman Podcast #106           | 48:512       | And our brain is there. There's some there's quite a few differences. Are some of them to you either interesting or perhaps profound in terms of in terms of the gap we might want to try to close in trying to create a human level intelligence.         |  1846.840000 | 1865.840000 |   0.719560 |
| Podcast: Yann LeCun: Dark Matter of Intelligence and Self-Supervised Learning | Lex Fridman Podcast #258   | 276:2642     | Have these, I mean, small pockets of beautiful complexity. Does that, do cellular automata, do these kinds of emergence and complex systems give you some intuition or guide your understanding of machine learning systems and neural networks and so on? |  8628.160000 | 8646.160000 |   0.735722 |
| Podcast: Stephen Wolfram: Fundamental Theory of Physics, Life, and the Universe | Lex Fridman Podcast #124 | 2:152        | So is there something like that with physics where so deep learning neural networks have been around for a long time?                                                                                                                                      |   610.860000 |  618.860000 |   0.736697 |
+------------------------------------------------------------------------------------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+-------------+------------+


=== Q4: 5 most similar to 51:56 ===
+---------------------------------------------------------------------------------------------------------------+--------------+--------------------------------------------------------------+--------------+-------------+------------+
| podcast_title                                                                                                 | segment_id   | content                                                      |   start_time |    end_time |   distance |
|---------------------------------------------------------------------------------------------------------------+--------------+--------------------------------------------------------------+--------------+-------------+------------|
| Podcast: George Hotz: Hacking the Simulation & Learning to Drive with Neural Nets | Lex Fridman Podcast #132  | 308:144      | I mean, we don't understand dark energy, right?              |   500.440000 |  502.600000 |   0.668197 |
| Podcast: Lex Fridman: Ask Me Anything - AMA January 2021 | Lex Fridman Podcast                                | 243:273      | Like, what's up with this dark matter and dark energy stuff? |   946.220000 |  950.120000 |   0.735551 |
| Podcast: Katherine de Kleer: Planets, Moons, Asteroids & Life in Our Solar System | Lex Fridman Podcast #184  | 196:685      | being like, what the hell is dark matter and dark energy?    |  2591.720000 | 2595.960000 |   0.763114 |
| Podcast: Alex Filippenko: Supernovae, Dark Energy, Aliens & the Expanding Universe | Lex Fridman Podcast #137 | 51:36        | Do we have any understanding of what the heck that thing is? |   216.000000 |  219.000000 |   0.792202 |
| Podcast: Leonard Susskind: Quantum Mechanics, String Theory and Black Holes | Lex Fridman Podcast #41         | 122:831      | That is a big question in physics right now.                 |  2374.900000 | 2377.620000 |   0.802270 |
+---------------------------------------------------------------------------------------------------------------+--------------+--------------------------------------------------------------+--------------+-------------+------------+


=== Q5a: 5 episodes similar to segment 267:476 ===
+---------------------------------------------------------------------------------------------------------+------------+
| title                                                                                                   |   distance |
|---------------------------------------------------------------------------------------------------------+------------|
| Podcast: Sara Walker: The Origin of Life on Earth and Alien Worlds | Lex Fridman Podcast #198           |   0.782898 |
| Podcast: Martin Rees: Black Holes, Alien Life, Dark Matter, and the Big Bang | Lex Fridman Podcast #305 |   0.787950 |
| Podcast: Max Tegmark: Life 3.0 | Lex Fridman Podcast #1                                                 |   0.788690 |
| Podcast: Sean Carroll: The Nature of the Universe, Life, and Intelligence | Lex Fridman Podcast #26     |   0.789065 |
| Podcast: Nick Bostrom: Simulation and Superintelligence | Lex Fridman Podcast #83                       |   0.791121 |
+---------------------------------------------------------------------------------------------------------+------------+


=== Q5b: 5 episodes similar to segment 48:511 ===
+---------------------------------------------------------------------------------------------------------+------------+
| title                                                                                                   |   distance |
|---------------------------------------------------------------------------------------------------------+------------|
| Podcast: Christof Koch: Consciousness | Lex Fridman Podcast #2                                          |   0.753780 |
| Podcast: Dileep George: Brain-Inspired AI | Lex Fridman Podcast #115                                    |   0.760515 |
| Podcast: Tomaso Poggio: Brains, Minds, and Machines | Lex Fridman Podcast #13                           |   0.761555 |
| Podcast: Elon Musk: Neuralink, AI, Autopilot, and the Pale Blue Dot | Lex Fridman Podcast #49           |   0.776152 |
| Podcast: Philip Goff: Consciousness, Panpsychism, and the Philosophy of Mind | Lex Fridman Podcast #261 |   0.787206 |
+---------------------------------------------------------------------------------------------------------+------------+


=== Q5c: 5 episodes similar to segment 51:56 ===
+------------------------------------------------------------------------------------------------------------+------------+
| title                                                                                                      |   distance |
|------------------------------------------------------------------------------------------------------------+------------|
| Podcast: Sean Carroll: Quantum Mechanics and the Many-Worlds Interpretation | Lex Fridman Podcast #47      |   0.776714 |
| Podcast: Stephen Wolfram: Fundamental Theory of Physics, Life, and the Universe | Lex Fridman Podcast #124 |   0.808071 |
| Podcast: Donald Hoffman: Reality is an Illusion - How Evolution Hid the Truth | Lex Fridman Podcast #293   |   0.816583 |
| Podcast: Cumrun Vafa: String Theory | Lex Fridman Podcast #204                                             |   0.817347 |
| Podcast: Avi Loeb: Aliens, Black Holes, and the Mystery of the Oumuamua | Lex Fridman Podcast #154         |   0.825452 |
+------------------------------------------------------------------------------------------------------------+------------+


=== Q6: 5 episodes similar to episode VeH7qKZr0WI ===
+---------------------------------------------------------------------------------------------------------------+------------+
| title                                                                                                         |   distance |
|---------------------------------------------------------------------------------------------------------------+------------|
| Podcast: Tyler Cowen: Economic Growth & the Fight Against Conformity & Mediocrity | Lex Fridman Podcast #174  |   0.119501 |
| Podcast: Eric Weinstein: Difficult Conversations, Freedom of Speech, and Physics | Lex Fridman Podcast #163   |   0.125714 |
| Podcast: Michael Malice and Yaron Brook: Ayn Rand, Human Nature, and Anarchy | Lex Fridman Podcast #178       |   0.128427 |
| Podcast: Steve Keen: Marxism, Capitalism, and Economics | Lex Fridman Podcast #303                            |   0.129163 |
| Podcast: Michael Malice: The White Pill, Freedom, Hope, and Happiness Amidst Chaos | Lex Fridman Podcast #150 |   0.130409 |
+---------------------------------------------------------------------------------------------------------------+------------+